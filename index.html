<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#667eea">
    <title>Flower Market - –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
            padding: 20px; 
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            padding-bottom: 20px; 
        }
        .header { 
            text-align: center; 
            color: white; 
            margin-bottom: 30px; 
            padding-top: 20px; 
        }
        .header h1 { 
            font-size: 24px; 
            margin-bottom: 8px; 
            font-weight: 600; 
        }
        .form-container { 
            background: white; 
            border-radius: 20px; 
            padding: 25px; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.3); 
            margin-bottom: 20px; 
        }
        .form-step { display: none; }
        .form-step.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .step-title { 
            font-size: 20px; 
            color: #333; 
            margin-bottom: 25px; 
            text-align: center; 
            font-weight: 600; 
        }
        .form-group { margin-bottom: 25px; }
        label { 
            display: block; 
            margin-bottom: 10px; 
            color: #555; 
            font-weight: 500; 
            font-size: 15px; 
        }
        input, textarea, select { 
            width: 100%; 
            padding: 14px 16px; 
            border: 2px solid #e0e0e0; 
            border-radius: 12px; 
            font-size: 16px; 
            transition: all 0.3s ease; 
            background: #fff; 
        }
        textarea { min-height: 140px; resize: vertical; line-height: 1.5; }
        .photo-upload { 
            border: 3px dashed #667eea; 
            border-radius: 12px; 
            padding: 40px 20px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            background: rgba(102, 126, 234, 0.05); 
        }
        #photoPreview { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 12px; 
            margin-top: 20px; 
        }
        .photo-item { 
            position: relative; 
            width: 100px; 
            height: 100px; 
            border-radius: 12px; 
            overflow: hidden; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
        }
        .photo-item img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
        }
        .contact-options { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 15px; 
            margin-bottom: 25px; 
        }
        .contact-option { 
            padding: 20px 15px; 
            border: 2px solid #e0e0e0; 
            border-radius: 12px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s ease; 
        }
        .contact-option.active { 
            border-color: #667eea; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
        }
        .btn { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            border: none; 
            padding: 16px 30px; 
            border-radius: 12px; 
            font-size: 16px; 
            font-weight: 600; 
            cursor: pointer; 
            width: 100%; 
            transition: all 0.3s ease; 
        }
        .btn:hover { transform: translateY(-2px); }
        .btn-secondary { background: #f0f0f0; color: #333; }
        .navigation { display: flex; gap: 15px; margin-top: 30px; }
        .notification { 
            position: fixed; 
            top: 20px; 
            left: 50%; 
            transform: translateX(-50%) translateY(-100px); 
            background: white; 
            padding: 15px 20px; 
            border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
            z-index: 1000; 
            transition: transform 0.4s ease; 
            max-width: 90%; 
            width: 400px; 
        }
        .notification.show { transform: translateX(-50%) translateY(0); }
        .loader { 
            display: inline-block; 
            width: 20px; 
            height: 20px; 
            border: 3px solid rgba(255,255,255,0.3); 
            border-radius: 50%; 
            border-top-color: white; 
            animation: spin 1s ease-in-out infinite; 
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .success-screen { text-align: center; padding: 40px 20px; }
        .success-icon { font-size: 80px; color: #34c759; margin-bottom: 25px; }
        .success-title { font-size: 28px; color: #333; margin-bottom: 15px; font-weight: 600; }
        @media (max-width: 600px) { 
            body { padding: 15px; } 
            .form-container { padding: 20px; } 
            .contact-options { grid-template-columns: 1fr; }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-flower-tulip"></i> Flower Market KG</h1>
            <p>–°–æ–∑–¥–∞–π—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–¥–∞–∂–µ —Ü–≤–µ—Ç–æ–≤</p>
            <p style="font-size: 12px; opacity: 0.8; margin-top: 5px;">–ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Telegram –≥—Ä—É–ø–ø–µ</p>
        </div>
        
        <div class="notification" id="notification"></div>
        
        <div class="form-container" id="formContainer">
            <!-- –®–∞–≥ 1: –§–æ—Ç–æ -->
            <div class="form-step active" id="step1">
                <h2 class="step-title"><i class="fas fa-camera"></i> –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞</h2>
                <div class="form-group">
                    <div class="photo-upload" id="photoUpload">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: #667eea; margin-bottom: 15px;"></i>
                        <p>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ</p>
                        <p style="color: #888; font-size: 13px; margin-top: 8px;">–ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ 5 —Ñ–æ—Ç–æ</p>
                    </div>
                    <input type="file" id="photoInput" accept="image/*" multiple>
                    <div id="photoPreview"></div>
                </div>
                <div class="navigation"><button class="btn" onclick="nextStep()">–î–∞–ª–µ–µ <i class="fas fa-arrow-right"></i></button></div>
            </div>
            
            <!-- –®–∞–≥ 2: –û–ø–∏—Å–∞–Ω–∏–µ -->
            <div class="form-step" id="step2">
                <h2 class="step-title"><i class="fas fa-edit"></i> –û–ø–∏—Å–∞–Ω–∏–µ</h2>
                <div class="form-group">
                    <label for="description">–û–ø–∏—à–∏—Ç–µ —Ç–æ–≤–∞—Ä:</label>
                    <textarea id="description" placeholder="–ü—Ä–∏–º–µ—Ä: –°–≤–µ–∂–∏–µ —Ä–æ–∑—ã –∫—Ä–∞—Å–Ω—ã–µ, –¥–ª–∏–Ω–æ–π 50—Å–º. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –±—É–∫–µ—Ç–æ–≤. –°–∞–º–æ–≤—ã–≤–æ–∑ –∏–ª–∏ –¥–æ—Å—Ç–∞–≤–∫–∞."></textarea>
                </div>
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="prevStep()"><i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥</button>
                    <button class="btn" onclick="nextStep()">–î–∞–ª–µ–µ <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            
            <!-- –®–∞–≥ 3: –¶–µ–Ω–∞ -->
            <div class="form-step" id="step3">
                <h2 class="step-title"><i class="fas fa-tag"></i> –¶–µ–Ω–∞</h2>
                <div class="form-group">
                    <label for="price">–¶–µ–Ω–∞ –≤ —Å–æ–º–∞—Ö:</label>
                    <input type="text" id="price" placeholder="–ü—Ä–∏–º–µ—Ä: 1500 —Å–æ–º –∏–ª–∏ 1000-2000">
                </div>
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="prevStep()"><i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥</button>
                    <button class="btn" onclick="nextStep()">–î–∞–ª–µ–µ <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            
            <!-- –®–∞–≥ 4: –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
            <div class="form-step" id="step4">
                <h2 class="step-title"><i class="fas fa-phone"></i> –ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
                <div class="contact-options">
                    <div class="contact-option active" id="telegramOption" onclick="selectContactType('telegram')">
                        <i class="fab fa-telegram"></i>
                        <p>Telegram</p>
                    </div>
                    <div class="contact-option" id="phoneOption" onclick="selectContactType('phone')">
                        <i class="fas fa-phone"></i>
                        <p>–¢–µ–ª–µ—Ñ–æ–Ω</p>
                    </div>
                </div>
                <div class="form-group" id="telegramInputGroup">
                    <label for="telegram">Telegram username:</label>
                    <input type="text" id="telegram" placeholder="@username">
                </div>
                <div class="form-group" id="phoneInputGroup" style="display: none;">
                    <label for="phone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</label>
                    <input type="tel" id="phone" placeholder="+996 XXX XXX XXX">
                </div>
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="prevStep()"><i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥</button>
                    <button class="btn" onclick="nextStep()">–î–∞–ª–µ–µ <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            
            <!-- –®–∞–≥ 5: –ü—Ä–µ–≤—å—é -->
            <div class="form-step" id="step5">
                <h2 class="step-title"><i class="fas fa-eye"></i> –ü—Ä–µ–≤—å—é</h2>
                <div class="form-group">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; border: 2px solid #e9ecef;">
                        <h3 style="color: #667eea; margin-bottom: 15px;">–í–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ:</h3>
                        <div id="previewContent"></div>
                    </div>
                </div>
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="prevStep()"><i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥</button>
                    <button class="btn" onclick="submitForm()" id="submitBtn"><i class="fas fa-paper-plane"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>
        
        <div class="form-container" id="successScreen" style="display: none;">
            <div class="success-screen">
                <i class="fas fa-check-circle success-icon"></i>
                <h2 class="success-title" id="successTitle">–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ!</h2>
                <p id="successMessage">–í–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –≥—Ä—É–ø–ø—É.</p>
                <p style="margin: 20px 0; color: #667eea; font-weight: 600;">
                    <a href="https://t.me/flowers_kg_bot" target="_blank" style="color: #667eea;">ü§ñ –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞</a>
                </p>
                <button class="btn" onclick="createNewAd()" style="margin-top: 20px;">
                    <i class="fas fa-plus"></i> –ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                </button>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const SERVER_URL = 'https://backend-flower-production.up.railway.app';
        const MAX_PHOTOS = 5;
        
        // –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
        let formData = {
            photos: [],
            description: '',
            price: '',
            contact_type: 'telegram',
            contacts: '',
            location: { address: '–≥. –ë–∏—à–∫–µ–∫' }
        };
        
        let currentStep = 1;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            checkServerStatus();
        });
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
        async function checkServerStatus() {
            try {
                const response = await fetch(SERVER_URL + '/health');
                if (response.ok) {
                    console.log('‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω');
                }
            } catch (error) {
                showNotification('–í–Ω–∏–º–∞–Ω–∏–µ', '–°–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', 'warning');
            }
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
        function setupEventListeners() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
            document.getElementById('photoUpload').addEventListener('click', () => {
                document.getElementById('photoInput').click();
            });
            
            document.getElementById('photoInput').addEventListener('change', handlePhotoUpload);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
            document.getElementById('description').addEventListener('input', (e) => {
                formData.description = e.target.value;
            });
            
            document.getElementById('price').addEventListener('input', (e) => {
                formData.price = e.target.value;
            });
            
            document.getElementById('telegram').addEventListener('input', (e) => {
                if (formData.contact_type === 'telegram') {
                    formData.contacts = e.target.value;
                }
            });
            
            document.getElementById('phone').addEventListener('input', (e) => {
                if (formData.contact_type === 'phone') {
                    formData.contacts = e.target.value;
                }
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ
        function handlePhotoUpload(event) {
            const files = Array.from(event.target.files);
            
            if (formData.photos.length + files.length > MAX_PHOTOS) {
                showNotification('–û—à–∏–±–∫–∞', `–ú–∞–∫—Å–∏–º—É–º ${MAX_PHOTOS} —Ñ–æ—Ç–æ`);
                return;
            }
            
            files.forEach(file => {
                if (!file.type.startsWith('image/')) {
                    showNotification('–û—à–∏–±–∫–∞', '–¢–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    formData.photos.push(e.target.result);
                    updatePhotoPreview();
                };
                reader.readAsDataURL(file);
            });
            
            event.target.value = '';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é —Ñ–æ—Ç–æ
        function updatePhotoPreview() {
            const preview = document.getElementById('photoPreview');
            preview.innerHTML = '';
            
            formData.photos.forEach((photo, index) => {
                const div = document.createElement('div');
                div.className = 'photo-item';
                
                const img = document.createElement('img');
                img.src = photo;
                img.alt = `–§–æ—Ç–æ ${index + 1}`;
                
                const removeBtn = document.createElement('div');
                removeBtn.innerHTML = '√ó';
                removeBtn.style.cssText = `
                    position: absolute;
                    top: 5px;
                    right: 5px;
                    background: #ff3b30;
                    color: white;
                    width: 24px;
                    height: 24px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    font-size: 18px;
                    font-weight: bold;
                `;
                removeBtn.onclick = () => {
                    formData.photos.splice(index, 1);
                    updatePhotoPreview();
                };
                
                div.appendChild(img);
                div.appendChild(removeBtn);
                preview.appendChild(div);
            });
        }
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —à–∞–≥–∞–º
        function showStep(step) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —à–∞–≥–∏
            document.querySelectorAll('.form-step').forEach(el => {
                el.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —à–∞–≥
            document.getElementById(`step${step}`).classList.add('active');
            currentStep = step;
            
            // –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–µ–≤—å—é, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
            if (step === 5) {
                updatePreview();
            }
        }
        
        function nextStep() {
            if (!validateStep(currentStep)) return;
            
            if (currentStep < 5) {
                saveStepData(currentStep);
                showStep(currentStep + 1);
            }
        }
        
        function prevStep() {
            if (currentStep > 1) {
                showStep(currentStep - 1);
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —à–∞–≥–∞
        function saveStepData(step) {
            switch(step) {
                case 2:
                    formData.description = document.getElementById('description').value.trim();
                    break;
                case 3:
                    formData.price = document.getElementById('price').value.trim();
                    break;
                case 4:
                    if (formData.contact_type === 'telegram') {
                        formData.contacts = document.getElementById('telegram').value.trim();
                    } else {
                        formData.contacts = document.getElementById('phone').value.trim();
                    }
                    break;
            }
        }
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è
        function validateStep(step) {
            switch(step) {
                case 1:
                    if (formData.photos.length === 0) {
                        showNotification('–î–æ–±–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ', '–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞');
                        return false;
                    }
                    break;
                case 2:
                    const desc = document.getElementById('description').value.trim();
                    if (!desc || desc.length < 3) {
                        showNotification('–û—à–∏–±–∫–∞', '–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞)');
                        document.getElementById('description').focus();
                        return false;
                    }
                    break;
                case 3:
                    const price = document.getElementById('price').value.trim();
                    if (!price) {
                        showNotification('–û—à–∏–±–∫–∞', '–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É');
                        document.getElementById('price').focus();
                        return false;
                    }
                    break;
                case 4:
                    const contacts = formData.contact_type === 'telegram' 
                        ? document.getElementById('telegram').value.trim()
                        : document.getElementById('phone').value.trim();
                    
                    if (!contacts) {
                        showNotification('–û—à–∏–±–∫–∞', '–í–≤–µ–¥–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã');
                        return false;
                    }
                    break;
            }
            return true;
        }
        
        // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
        function selectContactType(type) {
            formData.contact_type = type;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('telegramOption').classList.toggle('active', type === 'telegram');
            document.getElementById('phoneOption').classList.toggle('active', type === 'phone');
            
            document.getElementById('telegramInputGroup').style.display = type === 'telegram' ? 'block' : 'none';
            document.getElementById('phoneInputGroup').style.display = type === 'phone' ? 'block' : 'none';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é
        function updatePreview() {
            let previewHTML = '';
            
            // –§–æ—Ç–æ
            previewHTML += `<p><strong>üì∏ –§–æ—Ç–æ:</strong> ${formData.photos.length} —à—Ç.</p>`;
            
            // –û–ø–∏—Å–∞–Ω–∏–µ
            previewHTML += `<p><strong>üìù –û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${formData.description || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>`;
            
            // –¶–µ–Ω–∞
            previewHTML += `<p><strong>üí∞ –¶–µ–Ω–∞:</strong> ${formData.price || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>`;
            
            // –ö–æ–Ω—Ç–∞–∫—Ç—ã
            const contactType = formData.contact_type === 'telegram' ? 'Telegram' : '–¢–µ–ª–µ—Ñ–æ–Ω';
            previewHTML += `<p><strong>üì± –ö–æ–Ω—Ç–∞–∫—Ç—ã (${contactType}):</strong> ${formData.contacts || '–ù–µ —É–∫–∞–∑–∞–Ω—ã'}</p>`;
            
            document.getElementById('previewContent').innerHTML = previewHTML;
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
        async function submitForm() {
            if (!validateStep(5)) return;
            
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<div class="loader"></div> –ü—É–±–ª–∏–∫–∞—Ü–∏—è...';
            submitBtn.disabled = true;
            
            try {
                // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                const postData = {
                    photos: formData.photos,
                    description: formData.description,
                    price: formData.price,
                    contact_type: formData.contact_type,
                    contacts: formData.contacts,
                    location: formData.location,
                    timestamp: new Date().toISOString()
                };
                
                console.log('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä...');
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                const response = await fetch(SERVER_URL + '/api/create-ad', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(postData)
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω —É—Å–ø–µ—Ö–∞
                    showSuccessScreen(result.data.id);
                    
                    showNotification(
                        '‚úÖ –£—Å–ø–µ—Ö!', 
                        `–û–±—ä—è–≤–ª–µ–Ω–∏–µ #${result.data.id} –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ`, 
                        'success'
                    );
                } else {
                    throw new Error(result.error || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                }
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞', error.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ');
                
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω —É—Å–ø–µ—Ö–∞
        function showSuccessScreen(adId) {
            document.getElementById('formContainer').style.display = 'none';
            document.getElementById('successScreen').style.display = 'block';
            
            if (adId) {
                document.getElementById('successTitle').textContent = `–û–±—ä—è–≤–ª–µ–Ω–∏–µ #${adId} –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ!`;
                document.getElementById('successMessage').textContent = 
                    `–í–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±—ã–ª–æ —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –≤ Telegram –≥—Ä—É–ø–ø–µ.`;
            }
        }
        
        // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
        function createNewAd() {
            // –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
            formData = {
                photos: [],
                description: '',
                price: '',
                contact_type: 'telegram',
                contacts: '',
                location: { address: '–≥. –ë–∏—à–∫–µ–∫' }
            };
            
            // –°–±—Ä–æ—Å –ø–æ–ª–µ–π
            document.getElementById('photoPreview').innerHTML = '';
            document.getElementById('photoInput').value = '';
            document.getElementById('description').value = '';
            document.getElementById('price').value = '';
            document.getElementById('telegram').value = '';
            document.getElementById('phone').value = '';
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É
            document.getElementById('successScreen').style.display = 'none';
            document.getElementById('formContainer').style.display = 'block';
            
            // –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–µ—Ä–≤–æ–º—É —à–∞–≥—É
            currentStep = 1;
            showStep(1);
            selectContactType('telegram');
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(title, message, type = 'error') {
            const notification = document.getElementById('notification');
            
            let bgColor, textColor;
            switch(type) {
                case 'success':
                    bgColor = '#d4edda';
                    textColor = '#155724';
                    break;
                case 'warning':
                    bgColor = '#fff3cd';
                    textColor = '#856404';
                    break;
                default:
                    bgColor = '#f8d7da';
                    textColor = '#721c24';
            }
            
            notification.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px;">${title}</div>
                <div>${message}</div>
            `;
            
            notification.style.background = bgColor;
            notification.style.color = textColor;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }
    </script>
</body>
</html>